const apiUrl = https://script.google.com/macros/s/AKfycbzY4-g2QZ7HuOgFRBw2v4Hmc-0GbwVfga9NCkwVPDM/dev;

async function loadData() {
    try {
        const response = await fetch(apiUrl);
        const data = await response.json();

        // Display balance
        document.getElementById('remaining-balance').textContent = data.balance.toFixed(2);

        // Display payment history
        const paymentList = document.getElementById('payment-list');
        paymentList.innerHTML = '';
        data.payments.slice(1).forEach(payment => {
            const entry = document.createElement('div');
            entry.className = 'payment-entry';
            entry.innerHTML = `<span>${payment[0]}</span><span>â‚¬${parseFloat(payment[1]).toFixed(2)}</span>`;
            paymentList.appendChild(entry);
        });
    } catch (error) {
        console.error('Error loading data:', error);
    }
}

async function addPayment() {
    const amount = parseFloat(document.getElementById('payment-amount').value);
    const date = document.getElementById('payment-date').value;

    if (!amount || !date) {
        alert('Please enter a valid amount and date.');
        return;
    }

    try {
        // Send data via POST request
        const response = await fetch(apiUrl, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            body: `amount=${amount}&date=${date}`
        });

        if (response.ok) {
            alert('Payment added successfully');
            loadData(); // Reload data to display the updated balance and history
        } else {
            alert('Failed to add payment');
        }
    } catch (error) {
        console.error('Error adding payment:', error);
    }

    // Clear input fields
    document.getElementById('payment-amount').value = '';
    document.getElementById('payment-date').value = '';
}

// Load data on page load
loadData();
